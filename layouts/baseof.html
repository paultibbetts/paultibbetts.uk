<!doctype html>
<html lang="en-GB" class="bg-night text-light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {{- block "title" . -}}
        {{- $site := .Site.Title -}}
        {{- if .Params.page_title -}}
          {{ .Params.page_title }}
        {{- else if .IsHome -}}
          {{ $site }}
        {{- else -}}
          {{- with .Title -}}
            {{ . }}
            -
            {{ $site }}
          {{- else -}}
            {{ $site }}
          {{- end -}}
        {{- end -}}
      {{- end -}}
    </title>
    {{- $metaDescription := "" -}}
    {{- with .Description -}}
      {{- $metaDescription = . -}}
    {{- else -}}
      {{- with .Summary -}}
        {{- $metaDescription = . | plainify -}}
      {{- end -}}
    {{- end -}}
    {{- if not $metaDescription -}}
      {{- with .Site.Params.description -}}
        {{- $metaDescription = . -}}
      {{- else -}}
        {{- $metaDescription = "Blog" -}}
      {{- end -}}
    {{- end -}}
    <meta
      name="description"
      content="{{ $metaDescription | plainify | htmlUnescape | replaceRE `\\s+` ` ` | truncate 160 }}"
    />
    {{- with .OutputFormats.Get "rss" -}}
      {{- printf `
        <link rel=%q type=%q href=%q title=%q>` .Rel .MediaType.Type .Permalink site.Title | safeHTML
      -}}
    {{ end }}
    <link rel="webmention" href="https://webmention.io/paultibbetts.uk/webmention" />
    <link rel="alternate" type="text/mf2+html" href="/feed/" title="All posts" />
    {{ partial "opengraph.html" . }}
    {{ if hugo.IsProduction }}
      {{ with (templates.Defer (dict "key" "global")) }}
        {{ partial "css.html" . }}
      {{ end }}
    {{ else }}
      {{ partial "css.html" . }}
    {{ end }}
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="fediverse:creator" content="@paultibbetts@indieweb.social" />
  </head>

  <body>
    {{- partial "header.html" . -}}
    <main>
      {{- block "main" . }}{{ end -}}
    </main>
    {{ partial "follow.html" . }}
    {{ partial "footer.html" . }}
  </body>
</html>
